#include <Semaforo.h>
#FUSES NOWDT, NOMCLR

typedef enum {
    VERDE,
    AMARILLO,
    ROJO
} EstadoSemaforo;

void INIT_GPIO();
void INIT_TIMER_0();

void main()
{
    INIT_GPIO();
    EstadoSemaforo estado = VERDE;
    output_toggle(PIN_A2);
    while (TRUE) {
        switch (estado) {
            case VERDE:
                delay_ms(500);  // 5 segundos
                output_toggle(PIN_A2);
                output_toggle(PIN_A3);
                estado = AMARILLO;
                break;

            case AMARILLO:            
                delay_ms(200);   // 2 segundos
                output_toggle(PIN_A3);
                output_toggle(PIN_A4);
                estado = ROJO;
                break;

            case ROJO:
                delay_ms(500);                 // 5 segundos
                output_toggle(PIN_A4);
                output_toggle(PIN_A2);
                estado = VERDE;
                break;
        }
    }
}

void INIT_GPIO()
{
   set_tris_a(0b00100000);
   output_a(0b00100000);
}

void INIT_TIMER_0()
{
setup_timer_0(RTCC_INTERNAL | RTCC_DIV_X);
set_timer0(valor); //Se recarga el timer0
enable_interrupts(INT_TIMER0); // Habilita interrupcion timer0
enable_interrupts(global); // Habilita interrupciones globales
}
